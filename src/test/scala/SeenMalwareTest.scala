import org.scalatest.FunSpec //Similar to Ruby's RSpec

import com.typesafe.config._
import play.api.libs.json.Json
import models.SeenMalware

class SeenMalwareSpec extends FunSpec {
  describe("SeenMalware") {
    it("should parse JSON") {
      val jsonString = """
        {
        | "ts": 1480976958,
        | "pt": 42,
        | "si": "465635de-893d-4691-93bd-47ab5c24f4a4",
        | "uu": "022ec83c-c6ba-44c4-8533-7c4108e61e74",
        | "bg": "2813914c-1464-42b7-b571-a1b4a4eb07ec",
        | "sha": "1839632018638fba1e2272e7cbcf049994a5a7765251f3acbd3806c839f445af",
        | "nm": "Lotstring.key",
        | "ph": "/soccer/15EZTURZ70P5C7JUK/Litte Dipper/Lotstring.key",
        | "dp": 2
        |}
      """.stripMargin

      val malware = Json.parse(jsonString).as[SeenMalware]
      assert(malware.sha256 === "1839632018638fba1e2272e7cbcf049994a5a7765251f3acbd3806c839f445af")
      assert(malware.disposition === 2)
      assert(malware.count === 1)
    }
  }
}
